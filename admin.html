<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RR Mobile Accessories - Admin Panel</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --danger: #f72585;
            --success: #4cc9f0;
            --warning: #f8961e;
            --gray: #6c757d;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
        }
        
        /* Admin Layout */
        .admin-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar Styles */
        .admin-sidebar {
            width: 250px;
            background: linear-gradient(135deg, #0f2027, #203a43);
            color: white;
            padding: 20px 0;
            position: fixed;
            height: 100vh;
            transition: all 0.3s;
            z-index: 100;
        }
        
        .admin-brand {
            text-align: center;
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .admin-brand h2 {
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .admin-brand img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            margin-bottom: 10px;
        }
        
        .admin-menu {
            padding: 20px 0;
        }
        
        .menu-title {
            padding: 10px 20px;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.5);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .menu-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .menu-item:hover, .menu-item.active {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .menu-item i {
            margin-right: 10px;
            font-size: 1.1rem;
            width: 20px;
            text-align: center;
        }
        
        /* Main Content */
        .admin-main {
            flex: 1;
            margin-left: 250px;
            padding: 20px;
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            border-radius: 8px;
        }
        
        .admin-title h1 {
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .admin-user {
            display: flex;
            align-items: center;
        }
        
        .admin-user img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        .admin-user-info h4 {
            font-size: 0.9rem;
            margin-bottom: 2px;
        }
        
        .admin-user-info p {
            font-size: 0.8rem;
            color: var(--gray);
        }
        
        /* Dashboard Cards */
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .card-title {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        
        .card-icon.users {
            background: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }
        
        .card-icon.products {
            background: rgba(76, 201, 240, 0.1);
            color: var(--success);
        }
        
        .card-icon.orders {
            background: rgba(248, 149, 30, 0.1);
            color: var(--warning);
        }
        
        .card-icon.revenue {
            background: rgba(247, 37, 133, 0.1);
            color: var(--danger);
        }
        
        .card-icon.messages {
            background: rgba(106, 76, 147, 0.1);
            color: #6a4c93;
        }
        
        .card-value {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .card-footer {
            font-size: 0.8rem;
            color: var(--gray);
        }
        
        /* Tables */
        .table-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
            overflow-x: auto;
        }
        
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .table-title {
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .table-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-outline {
            background: white;
            border: 1px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        tr:hover {
            background: #f9f9f9;
        }
        
        .status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .status.pending {
            background: rgba(248, 149, 30, 0.1);
            color: var(--warning);
        }
        
        .status.completed {
            background: rgba(76, 201, 240, 0.1);
            color: var(--success);
        }
        
        .status.cancelled {
            background: rgba(247, 37, 133, 0.1);
            color: var(--danger);
        }
        
        .status.unread {
            background: rgba(247, 37, 133, 0.1);
            color: var(--danger);
        }
        
        .status.read {
            background: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }
        
        .status.replied {
            background: rgba(76, 201, 240, 0.1);
            color: var(--success);
        }
        
        .action-btn {
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            margin-right: 5px;
        }
        
        .action-btn.view {
            background: rgba(67, 97, 238, 0.1);
            color: var(--primary);
            border: none;
        }
        
        .action-btn.edit {
            background: rgba(248, 149, 30, 0.1);
            color: var(--warning);
            border: none;
        }
        
        .action-btn.delete {
            background: rgba(247, 37, 133, 0.1);
            color: var(--danger);
            border: none;
        }
        
        .action-btn.reply {
            background: rgba(76, 201, 240, 0.1);
            color: var(--success);
            border: none;
        }
        
        /* Form Styles */
        .form-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }
        
        .form-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            font-size: 0.9rem;
        }
        
        .form-control {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.9rem;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        textarea.form-control {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-row {
            display: flex;
            gap: 15px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        .form-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            display: none;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .modal {
            background: white;
            border-radius: 8px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            animation: modalFadeIn 0.3s;
        }
        
        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .modal-header {
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .modal-close {
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        /* Message Styles */
        .message-container {
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 20px;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 15px;
        }
        
        .message {
            margin-bottom: 15px;
            padding: 10px 15px;
            border-radius: 8px;
            position: relative;
        }
        
        .message.user {
            background-color: #f0f7ff;
            margin-right: 20%;
            border: 1px solid #d0e3ff;
        }
        
        .message.admin {
            background-color: #f0fff0;
            margin-left: 20%;
            border: 1px solid #d0ffd0;
        }
        
        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.8rem;
        }
        
        .message-sender {
            font-weight: 600;
        }
        
        .message-time {
            color: var(--gray);
        }
        
        .message-content {
            font-size: 0.9rem;
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .dashboard-cards {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .admin-sidebar {
                width: 70px;
                overflow: hidden;
            }
            
            .admin-sidebar .menu-title,
            .admin-sidebar .menu-item span {
                display: none;
            }
            
            .admin-sidebar .menu-item {
                justify-content: center;
                padding: 15px 0;
            }
            
            .admin-sidebar .menu-item i {
                margin-right: 0;
                font-size: 1.3rem;
            }
            
            .admin-main {
                margin-left: 70px;
            }
            
            .dashboard-cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <div class="admin-sidebar">
            <div class="admin-brand">
                <img src="https://i.ibb.co/mFPrvzHC/0a7ca26b-3215-4990-8d5a-b669b374e12f.png" alt="RR Logo">
                <h2>RR Mobile</h2>
            </div>
            
            <div class="admin-menu">
                <div class="menu-title">Main</div>
                <div class="menu-item active" id="dashboardBtn">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </div>
                
                <div class="menu-title">Management</div>
                <div class="menu-item" id="productsBtn">
                    <i class="fas fa-box"></i>
                    <span>Products</span>
                </div>
                <div class="menu-item" id="categoriesBtn">
                    <i class="fas fa-list"></i>
                    <span>Categories</span>
                </div>
                <div class="menu-item" id="ordersBtn">
                    <i class="fas fa-shopping-bag"></i>
                    <span>Orders</span>
                </div>
                <div class="menu-item" id="usersBtn">
                    <i class="fas fa-users"></i>
                    <span>Users</span>
                </div>
                <div class="menu-item" id="messagesBtn">
                    <i class="fas fa-envelope"></i>
                    <span>Messages</span>
                </div>
                
                <div class="menu-title">Settings</div>
                <div class="menu-item" id="settingsBtn">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </div>
                <div class="menu-item" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="admin-main">
            <!-- Dashboard Section -->
            <div id="dashboardSection">
                <div class="admin-header">
                    <div class="admin-title">
                        <h1>Dashboard</h1>
                    </div>
                    <div class="admin-user">
                        <img src="https://i.ibb.co/mFPrvzHC/0a7ca26b-3215-4990-8d5a-b669b374e12f.png" alt="Admin">
                        <div class="admin-user-info">
                            <h4>Admin User</h4>
                            <p>Super Admin</p>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-cards">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Total Users</div>
                            <div class="card-icon users">
                                <i class="fas fa-users"></i>
                            </div>
                        </div>
                        <div class="card-value" id="totalUsers">0</div>
                        <div class="card-footer">+10% from last month</div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Total Products</div>
                            <div class="card-icon products">
                                <i class="fas fa-box"></i>
                            </div>
                        </div>
                        <div class="card-value" id="totalProducts">0</div>
                        <div class="card-footer">+5 new products</div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Total Orders</div>
                            <div class="card-icon orders">
                                <i class="fas fa-shopping-bag"></i>
                            </div>
                        </div>
                        <div class="card-value" id="totalOrders">0</div>
                        <div class="card-footer">+15% from last month</div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Total Revenue</div>
                            <div class="card-icon revenue">
                                <i class="fas fa-rupee-sign"></i>
                            </div>
                        </div>
                        <div class="card-value" id="totalRevenue">₹0</div>
                        <div class="card-footer">+20% from last month</div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Unread Messages</div>
                            <div class="card-icon messages">
                                <i class="fas fa-envelope"></i>
                            </div>
                        </div>
                        <div class="card-value" id="unreadMessages">0</div>
                        <div class="card-footer">New messages from users</div>
                    </div>
                </div>
                
                <div class="table-container">
                    <div class="table-header">
                        <div class="table-title">Recent Orders</div>
                        <div class="table-actions">
                            <button class="btn btn-outline">View All</button>
                        </div>
                    </div>
                    
                    <table id="recentOrdersTable">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Customer</th>
                                <th>Date</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Orders will be loaded here -->
                        </tbody>
                    </table>
                </div>
                
                <div class="table-container">
                    <div class="table-header">
                        <div class="table-title">Recent Products</div>
                        <div class="table-actions">
                            <button class="btn btn-primary" id="addProductBtn">Add Product</button>
                        </div>
                    </div>
                    
                    <table id="recentProductsTable">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Category</th>
                                <th>Price</th>
                                <th>Stock</th>
                                <th>Rating</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Products will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Products Section -->
            <div id="productsSection" style="display: none;">
                <div class="admin-header">
                    <div class="admin-title">
                        <h1>Products Management</h1>
                    </div>
                    <div class="admin-user">
                        <img src="https://i.ibb.co/mFPrvzHC/0a7ca26b-3215-4990-8d5a-b669b374e12f.png" alt="Admin">
                        <div class="admin-user-info">
                            <h4>Admin User</h4>
                            <p>Super Admin</p>
                        </div>
                    </div>
                </div>
                
                <div class="table-container">
                    <div class="table-header">
                        <div class="table-title">All Products</div>
                        <div class="table-actions">
                            <button class="btn btn-primary" id="addNewProductBtn">Add New Product</button>
                        </div>
                    </div>
                    
                    <table id="allProductsTable">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Category</th>
                                <th>Price</th>
                                <th>Stock</th>
                                <th>Rating</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- All products will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Categories Section -->
            <div id="categoriesSection" style="display: none;">
                <div class="admin-header">
                    <div class="admin-title">
                        <h1>Categories Management</h1>
                    </div>
                    <div class="admin-user">
                        <img src="https://i.ibb.co/mFPrvzHC/0a7ca26b-3215-4990-8d5a-b669b374e12f.png" alt="Admin">
                        <div class="admin-user-info">
                            <h4>Admin User</h4>
                            <p>Super Admin</p>
                        </div>
                    </div>
                </div>
                
                <div class="table-container">
                    <div class="table-header">
                        <div class="table-title">All Categories</div>
                        <div class="table-actions">
                            <button class="btn btn-primary" id="addCategoryBtn">Add Category</button>
                        </div>
                    </div>
                    
                    <table id="categoriesTable">
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Products</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Categories will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Orders Section -->
            <div id="ordersSection" style="display: none;">
                <div class="admin-header">
                    <div class="admin-title">
                        <h1>Orders Management</h1>
                    </div>
                    <div class="admin-user">
                        <img src="https://i.ibb.co/mFPrvzHC/0a7ca26b-3215-4990-8d5a-b669b374e12f.png" alt="Admin">
                        <div class="admin-user-info">
                            <h4>Admin User</h4>
                            <p>Super Admin</p>
                        </div>
                    </div>
                </div>
                
                <div class="table-container">
                    <div class="table-header">
                        <div class="table-title">All Orders</div>
                        <div class="table-actions">
                            <button class="btn btn-outline">Export</button>
                        </div>
                    </div>
                    
                    <table id="allOrdersTable">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Customer</th>
                                <th>Date</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- All orders will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Users Section -->
            <div id="usersSection" style="display: none;">
                <div class="admin-header">
                    <div class="admin-title">
                        <h1>Users Management</h1>
                    </div>
                    <div class="admin-user">
                        <img src="https://i.ibb.co/mFPrvzHC/0a7ca26b-3215-4990-8d5a-b669b374e12f.png" alt="Admin">
                        <div class="admin-user-info">
                            <h4>Admin User</h4>
                            <p>Super Admin</p>
                        </div>
                    </div>
                </div>
                
                <div class="table-container">
                    <div class="table-header">
                        <div class="table-title">All Users</div>
                        <div class="table-actions">
                            <button class="btn btn-outline">Export</button>
                        </div>
                    </div>
                    
                    <table id="usersTable">
                        <thead>
                            <tr>
                                <th>User</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Orders</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Users will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Messages Section -->
            <div id="messagesSection" style="display: none;">
                <div class="admin-header">
                    <div class="admin-title">
                        <h1>Messages Management</h1>
                    </div>
                    <div class="admin-user">
                        <img src="https://i.ibb.co/mFPrvzHC/0a7ca26b-3215-4990-8d5a-b669b374e12f.png" alt="Admin">
                        <div class="admin-user-info">
                            <h4>Admin User</h4>
                            <p>Super Admin</p>
                        </div>
                    </div>
                </div>
                
                <div class="table-container">
                    <div class="table-header">
                        <div class="table-title">All Messages</div>
                        <div class="table-actions">
                            <button class="btn btn-outline">Mark All as Read</button>
                        </div>
                    </div>
                    
                    <table id="messagesTable">
                        <thead>
                            <tr>
                                <th>User</th>
                                <th>Subject</th>
                                <th>Last Message</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Messages will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Settings Section -->
            <div id="settingsSection" style="display: none;">
                <div class="admin-header">
                    <div class="admin-title">
                        <h1>Settings</h1>
                    </div>
                    <div class="admin-user">
                        <img src="https://i.ibb.co/mFPrvzHC/0a7ca26b-3215-4990-8d5a-b669b374e12f.png" alt="Admin">
                        <div class="admin-user-info">
                            <h4>Admin User</h4>
                            <p>Super Admin</p>
                        </div>
                    </div>
                </div>
                
                <div class="form-container">
                    <div class="form-title">Store Settings</div>
                    <form id="storeSettingsForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Store Name</label>
                                <input type="text" class="form-control" id="storeName" value="RR Mobile Accessories">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Store Logo URL</label>
                                <input type="text" class="form-control" id="storeLogo" value="https://i.ibb.co/mFPrvzHC/0a7ca26b-3215-4990-8d5a-b669b374e12f.png">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Store Description</label>
                            <textarea class="form-control" id="storeDescription">Your one-stop shop for all mobile accessories</textarea>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Contact Email</label>
                                <input type="email" class="form-control" id="contactEmail" value="contact@rrmobile.com">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Contact Phone</label>
                                <input type="text" class="form-control" id="contactPhone" value="+91 9876543210">
                            </div>
                        </div>
                        
                        <div class="form-footer">
                            <button type="button" class="btn btn-outline">Cancel</button>
                            <button type="submit" class="btn btn-primary">Save Changes</button>
                        </div>
                    </form>
                </div>
                
                <div class="form-container">
                    <div class="form-title">Admin Profile</div>
                    <form id="adminProfileForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Full Name</label>
                                <input type="text" class="form-control" id="adminName" value="Admin User">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" id="adminEmail" value="admin@rrmobile.com" disabled>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Profile Image URL</label>
                                <input type="text" class="form-control" id="adminImage" value="https://i.ibb.co/mFPrvzHC/0a7ca26b-3215-4990-8d5a-b669b374e12f.png">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Phone</label>
                                <input type="text" class="form-control" id="adminPhone" value="+91 9876543210">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Change Password</label>
                            <input type="password" class="form-control" id="adminPassword" placeholder="Enter new password">
                        </div>
                        
                        <div class="form-footer">
                            <button type="button" class="btn btn-outline">Cancel</button>
                            <button type="submit" class="btn btn-primary">Update Profile</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Add Product Modal -->
    <div class="modal-overlay" id="productModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">Add New Product</div>
                <div class="modal-close">&times;</div>
            </div>
            <div class="modal-body">
                <form id="productForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Product Name</label>
                            <input type="text" class="form-control" id="productName" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Category</label>
                            <select class="form-control" id="productCategory" required>
                                <option value="">Select Category</option>
                                <option value="headphones">Headphones</option>
                                <option value="covers">Mobile Covers</option>
                                <option value="chargers">Chargers</option>
                                <option value="powerbanks">Power Banks</option>
                                <option value="speakers">Speakers</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Description</label>
                        <textarea class="form-control" id="productDescription" required></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Price (₹)</label>
                            <input type="number" class="form-control" id="productPrice" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Original Price (₹)</label>
                            <input type="number" class="form-control" id="productOriginalPrice">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Discount (%)</label>
                            <input type="number" class="form-control" id="productDiscount">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Stock Quantity</label>
                            <input type="number" class="form-control" id="productStock" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Brand</label>
                            <input type="text" class="form-control" id="productBrand">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Image URL</label>
                        <input type="text" class="form-control" id="productImage" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Rating (1-5)</label>
                            <input type="number" class="form-control" id="productRating" min="1" max="5" step="0.1">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Rating Count</label>
                            <input type="number" class="form-control" id="productRatingCount">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Additional Features (JSON)</label>
                        <textarea class="form-control" id="productFeatures" placeholder='{"colors": ["Black", "Blue"], "battery": "20 hours"}'></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancelProductBtn">Cancel</button>
                <button class="btn btn-primary" id="saveProductBtn">Save Product</button>
            </div>
        </div>
    </div>
    
    <!-- Add Category Modal -->
    <div class="modal-overlay" id="categoryModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">Add New Category</div>
                <div class="modal-close">&times;</div>
            </div>
            <div class="modal-body">
                <form id="categoryForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Category Name</label>
                            <input type="text" class="form-control" id="categoryName" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Category ID (slug)</label>
                            <input type="text" class="form-control" id="categoryId" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Icon Class (Font Awesome)</label>
                        <input type="text" class="form-control" id="categoryIcon" placeholder="fas fa-headphones" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Image URL</label>
                        <input type="text" class="form-control" id="categoryImage" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancelCategoryBtn">Cancel</button>
                <button class="btn btn-primary" id="saveCategoryBtn">Save Category</button>
            </div>
        </div>
    </div>
    
    <!-- Order Details Modal -->
    <div class="modal-overlay" id="orderModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">Order Details</div>
                <div class="modal-close">&times;</div>
            </div>
            <div class="modal-body">
                <div id="orderDetailsContent">
                    <!-- Order details will be loaded here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="closeOrderBtn">Close</button>
                <button class="btn btn-primary" id="updateOrderBtn">Update Status</button>
            </div>
        </div>
    </div>
    
    <!-- Message Details Modal -->
    <div class="modal-overlay" id="messageModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">Message Conversation</div>
                <div class="modal-close">&times;</div>
            </div>
            <div class="modal-body">
                <div id="messageDetailsContent">
                    <!-- Message details will be loaded here -->
                </div>
                
                <div class="form-container" style="margin-top: 20px;">
                    <form id="replyForm">
                        <div class="form-group">
                            <label class="form-label">Your Reply</label>
                            <textarea class="form-control" id="replyMessage" required placeholder="Type your reply here..."></textarea>
                        </div>
                    </form>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="closeMessageBtn">Close</button>
                <button class="btn btn-success" id="sendReplyBtn">Send Reply</button>
            </div>
        </div>
    </div>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
    
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBOlLzr0liPHXEssNXSpY8XozoYPPEeA60",
            authDomain: "rr-mobile-accessories.firebaseapp.com",
            databaseURL: "https://rr-mobile-accessories-default-rtdb.firebaseio.com",
            projectId: "rr-mobile-accessories",
            storageBucket: "rr-mobile-accessories.appspot.com",
            messagingSenderId: "261034064103",
            appId: "1:261034064103:web:b59fbb7118dd7f93868a42",
            measurementId: "G-28RJEQ3X7H"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();
        
        // DOM Elements
        const dashboardBtn = document.getElementById('dashboardBtn');
        const productsBtn = document.getElementById('productsBtn');
        const categoriesBtn = document.getElementById('categoriesBtn');
        const ordersBtn = document.getElementById('ordersBtn');
        const usersBtn = document.getElementById('usersBtn');
        const messagesBtn = document.getElementById('messagesBtn');
        const settingsBtn = document.getElementById('settingsBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        
        const dashboardSection = document.getElementById('dashboardSection');
        const productsSection = document.getElementById('productsSection');
        const categoriesSection = document.getElementById('categoriesSection');
        const ordersSection = document.getElementById('ordersSection');
        const usersSection = document.getElementById('usersSection');
        const messagesSection = document.getElementById('messagesSection');
        const settingsSection = document.getElementById('settingsSection');
        
        const addProductBtn = document.getElementById('addProductBtn');
        const addNewProductBtn = document.getElementById('addNewProductBtn');
        const addCategoryBtn = document.getElementById('addCategoryBtn');
        
        const productModal = document.getElementById('productModal');
        const categoryModal = document.getElementById('categoryModal');
        const orderModal = document.getElementById('orderModal');
        const messageModal = document.getElementById('messageModal');
        
        const productForm = document.getElementById('productForm');
        const categoryForm = document.getElementById('categoryForm');
        const replyForm = document.getElementById('replyForm');
        
        const saveProductBtn = document.getElementById('saveProductBtn');
        const cancelProductBtn = document.getElementById('cancelProductBtn');
        const saveCategoryBtn = document.getElementById('saveCategoryBtn');
        const cancelCategoryBtn = document.getElementById('cancelCategoryBtn');
        const closeOrderBtn = document.getElementById('closeOrderBtn');
        const updateOrderBtn = document.getElementById('updateOrderBtn');
        const closeMessageBtn = document.getElementById('closeMessageBtn');
        const sendReplyBtn = document.getElementById('sendReplyBtn');
        
        const recentOrdersTable = document.getElementById('recentOrdersTable').getElementsByTagName('tbody')[0];
        const recentProductsTable = document.getElementById('recentProductsTable').getElementsByTagName('tbody')[0];
        const allProductsTable = document.getElementById('allProductsTable').getElementsByTagName('tbody')[0];
        const categoriesTable = document.getElementById('categoriesTable').getElementsByTagName('tbody')[0];
        const allOrdersTable = document.getElementById('allOrdersTable').getElementsByTagName('tbody')[0];
        const usersTable = document.getElementById('usersTable').getElementsByTagName('tbody')[0];
        const messagesTable = document.getElementById('messagesTable').getElementsByTagName('tbody')[0];
        
        const totalUsers = document.getElementById('totalUsers');
        const totalProducts = document.getElementById('totalProducts');
        const totalOrders = document.getElementById('totalOrders');
        const totalRevenue = document.getElementById('totalRevenue');
        const unreadMessages = document.getElementById('unreadMessages');
        
        // Global variables
        let currentUser = null;
        let products = [];
        let categories = [];
        let orders = [];
        let users = [];
        let messages = [];
        let currentOrder = null;
        let currentMessageThread = null;
        
        // Initialize the admin panel
        document.addEventListener('DOMContentLoaded', () => {
            // Check authentication
            auth.onAuthStateChanged((user) => {
                if (!user) {
                    window.location.href = 'login.html';
                } else {
                    currentUser = user;
                    loadData();
                }
            });
            
            // Setup event listeners
            setupEventListeners();
        });
        
        // Load all data from Firebase
        function loadData() {
            // Load products
            database.ref('products').on('value', (snapshot) => {
                products = [];
                recentProductsTable.innerHTML = '';
                allProductsTable.innerHTML = '';
                
                snapshot.forEach((childSnapshot) => {
                    const product = childSnapshot.val();
                    product.id = childSnapshot.key;
                    products.push(product);
                    
                    // Add to recent products table (first 5)
                    if (recentProductsTable.rows.length < 5) {
                        addProductToTable(product, recentProductsTable);
                    }
                    
                    // Add to all products table
                    addProductToTable(product, allProductsTable);
                });
                
                totalProducts.textContent = products.length;
            });
            
            // Load categories
            database.ref('categories').on('value', (snapshot) => {
                categories = [];
                categoriesTable.innerHTML = '';
                
                snapshot.forEach((childSnapshot) => {
                    const category = childSnapshot.val();
                    category.id = childSnapshot.key;
                    categories.push(category);
                    
                    // Add to categories table
                    addCategoryToTable(category);
                });
            });
            
            // Load orders
            database.ref('orders').on('value', (snapshot) => {
                orders = [];
                recentOrdersTable.innerHTML = '';
                allOrdersTable.innerHTML = '';
                
                snapshot.forEach((childSnapshot) => {
                    const order = childSnapshot.val();
                    order.id = childSnapshot.key;
                    orders.push(order);
                    
                    // Add to recent orders table (first 5)
                    if (recentOrdersTable.rows.length < 5) {
                        addOrderToTable(order, recentOrdersTable);
                    }
                    
                    // Add to all orders table
                    addOrderToTable(order, allOrdersTable);
                });
                
                totalOrders.textContent = orders.length;
                
                // Calculate total revenue
                const revenue = orders.reduce((total, order) => total + (order.total || 0), 0);
                totalRevenue.textContent = `₹${revenue.toLocaleString()}`;
            });
            
            // Load users
            database.ref('users').on('value', (snapshot) => {
                users = [];
                usersTable.innerHTML = '';
                
                snapshot.forEach((childSnapshot) => {
                    const user = childSnapshot.val();
                    user.id = childSnapshot.key;
                    users.push(user);
                    
                    // Add to users table
                    addUserToTable(user);
                });
                
                totalUsers.textContent = users.length;
            });
            
            // Load messages
            database.ref('messages').on('value', (snapshot) => {
                messages = [];
                messagesTable.innerHTML = '';
                let unreadCount = 0;
                
                snapshot.forEach((childSnapshot) => {
                    const messageThread = childSnapshot.val();
                    messageThread.id = childSnapshot.key;
                    
                    // Get the last message in the thread
                    const lastMessage = messageThread.messages 
                        ? messageThread.messages[Object.keys(messageThread.messages).pop()]
                        : null;
                    
                    if (lastMessage) {
                        const messageData = {
                            id: messageThread.id,
                            userId: messageThread.userId,
                            userEmail: messageThread.userEmail,
                            userName: messageThread.userName,
                            subject: messageThread.subject,
                            lastMessage: lastMessage.content,
                            timestamp: lastMessage.timestamp,
                            status: lastMessage.status || 'unread',
                            isAdminReply: lastMessage.isAdminReply || false
                        };
                        
                        messages.push(messageData);
                        
                        // Add to messages table
                        addMessageToTable(messageData);
                        
                        // Count unread messages
                        if (!messageData.isAdminReply && messageData.status === 'unread') {
                            unreadCount++;
                        }
                    }
                });
                
                unreadMessages.textContent = unreadCount;
                
                // Sort messages by timestamp (newest first)
                messages.sort((a, b) => b.timestamp - a.timestamp);
            });
        }
        
        // Add product to table
        function addProductToTable(product, table) {
            const row = table.insertRow();
            
            // Product name with image
            const productCell = row.insertCell(0);
            productCell.innerHTML = `
                <div style="display: flex; align-items: center;">
                    <img src="${product.image}" alt="${product.title}" style="width: 40px; height: 40px; object-fit: cover; border-radius: 4px; margin-right: 10px;">
                    <div>
                        <div style="font-weight: 500;">${product.title}</div>
                        <div style="font-size: 0.8rem; color: var(--gray);">${product.brand || 'No brand'}</div>
                    </div>
                </div>
            `;
            
            // Category
            const categoryCell = row.insertCell(1);
            categoryCell.textContent = product.category || '-';
            
            // Price
            const priceCell = row.insertCell(2);
            priceCell.innerHTML = `
                <div style="font-weight: 600; color: var(--primary);">₹${product.price}</div>
                ${product.originalPrice ? `<div style="font-size: 0.8rem; color: var(--gray); text-decoration: line-through;">₹${product.originalPrice}</div>` : ''}
            `;
            
            // Stock
            const stockCell = row.insertCell(3);
            stockCell.textContent = product.stock || 0;
            
            // Rating
            const ratingCell = row.insertCell(4);
            ratingCell.innerHTML = `
                <div style="display: flex; align-items: center;">
                    <div style="color: var(--warning); margin-right: 5px;">
                        ${getRatingStars(product.rating || 0)}
                    </div>
                    <div>${product.ratingCount || 0}</div>
                </div>
            `;
            
            // Actions
            const actionCell = row.insertCell(5);
            actionCell.innerHTML = `
                <button class="action-btn edit" data-id="${product.id}"><i class="fas fa-edit"></i></button>
                <button class="action-btn delete" data-id="${product.id}"><i class="fas fa-trash"></i></button>
            `;
        }
        
        // Add category to table
        function addCategoryToTable(category) {
            const row = categoriesTable.insertRow();
            
            // Category name with icon
            const nameCell = row.insertCell(0);
            nameCell.innerHTML = `
                <div style="display: flex; align-items: center;">
                    <i class="${category.icon}" style="margin-right: 10px; font-size: 1.2rem;"></i>
                    <div>
                        <div style="font-weight: 500;">${category.name}</div>
                        <div style="font-size: 0.8rem; color: var(--gray);">${category.id}</div>
                    </div>
                </div>
            `;
            
            // Product count
            const countCell = row.insertCell(1);
            const productCount = products.filter(p => p.category === category.id).length;
            countCell.textContent = productCount;
            
            // Actions
            const actionCell = row.insertCell(2);
            actionCell.innerHTML = `
                <button class="action-btn edit" data-id="${category.id}"><i class="fas fa-edit"></i></button>
                <button class="action-btn delete" data-id="${category.id}"><i class="fas fa-trash"></i></button>
            `;
        }
        
        // Add order to table
        function addOrderToTable(order, table) {
            const row = table.insertRow();
            
            // Order ID
            const idCell = row.insertCell(0);
            idCell.textContent = `#${order.id.substring(0, 8)}`;
            
            // Customer
            const customerCell = row.insertCell(1);
            customerCell.innerHTML = `
                <div style="font-weight: 500;">${order.userEmail}</div>
                <div style="font-size: 0.8rem; color: var(--gray);">${order.userId.substring(0, 8)}</div>
            `;
            
            // Date
            const dateCell = row.insertCell(2);
            const orderDate = new Date(order.createdAt);
            dateCell.textContent = orderDate.toLocaleDateString();
            
            // Amount
            const amountCell = row.insertCell(3);
            amountCell.innerHTML = `<div style="font-weight: 600;">₹${order.total || 0}</div>`;
            
            // Status
            const statusCell = row.insertCell(4);
            statusCell.innerHTML = `
                <span class="status ${order.status || 'pending'}">${order.status || 'pending'}</span>
            `;
            
            // Actions
            const actionCell = row.insertCell(5);
            actionCell.innerHTML = `
                <button class="action-btn view" data-id="${order.id}"><i class="fas fa-eye"></i></button>
                <button class="action-btn edit" data-id="${order.id}"><i class="fas fa-edit"></i></button>
            `;
        }
        
        // Add user to table
        function addUserToTable(user) {
            const row = usersTable.insertRow();
            
            // User
            const userCell = row.insertCell(0);
            userCell.innerHTML = `
                <div style="display: flex; align-items: center;">
                    <div style="width: 40px; height: 40px; border-radius: 50%; background: #eee; display: flex; align-items: center; justify-content: center; margin-right: 10px; overflow: hidden;">
                        ${user.photoURL ? 
                            `<img src="${user.photoURL}" alt="${user.name}" style="width: 100%; height: 100%; object-fit: cover;">` : 
                            `<span style="font-size: 1rem;">${user.name ? user.name.charAt(0).toUpperCase() : 'U'}</span>`
                        }
                    </div>
                    <div>
                        <div style="font-weight: 500;">${user.name || 'No name'}</div>
                        <div style="font-size: 0.8rem; color: var(--gray);">${user.id.substring(0, 8)}</div>
                    </div>
                </div>
            `;
            
            // Email
            const emailCell = row.insertCell(1);
            emailCell.textContent = user.email || '-';
            
            // Phone
            const phoneCell = row.insertCell(2);
            phoneCell.textContent = user.phone || '-';
            
            // Orders
            const ordersCell = row.insertCell(3);
            const userOrders = orders.filter(o => o.userId === user.id).length;
            ordersCell.textContent = userOrders;
            
            // Actions
            const actionCell = row.insertCell(4);
            actionCell.innerHTML = `
                <button class="action-btn view" data-id="${user.id}"><i class="fas fa-eye"></i></button>
                <button class="action-btn delete" data-id="${user.id}"><i class="fas fa-trash"></i></button>
            `;
        }
        
        // Add message to table
        function addMessageToTable(message) {
            const row = messagesTable.insertRow();
            
            // User
            const userCell = row.insertCell(0);
            userCell.innerHTML = `
                <div style="display: flex; align-items: center;">
                    <div style="width: 40px; height: 40px; border-radius: 50%; background: #eee; display: flex; align-items: center; justify-content: center; margin-right: 10px; overflow: hidden;">
                        <span style="font-size: 1rem;">${message.userName ? message.userName.charAt(0).toUpperCase() : 'U'}</span>
                    </div>
                    <div>
                        <div style="font-weight: 500;">${message.userName || 'No name'}</div>
                        <div style="font-size: 0.8rem; color: var(--gray);">${message.userEmail}</div>
                    </div>
                </div>
            `;
            
            // Subject
            const subjectCell = row.insertCell(1);
            subjectCell.textContent = message.subject || 'No subject';
            
            // Last Message (truncated)
            const messageCell = row.insertCell(2);
            const truncatedMessage = message.lastMessage.length > 50 
                ? message.lastMessage.substring(0, 50) + '...' 
                : message.lastMessage;
            messageCell.textContent = truncatedMessage;
            
            // Date
            const dateCell = row.insertCell(3);
            const messageDate = new Date(message.timestamp);
            dateCell.textContent = messageDate.toLocaleString();
            
            // Status
            const statusCell = row.insertCell(4);
            statusCell.innerHTML = `
                <span class="status ${message.isAdminReply ? 'replied' : message.status}">
                    ${message.isAdminReply ? 'replied' : message.status}
                </span>
            `;
            
            // Actions
            const actionCell = row.insertCell(5);
            actionCell.innerHTML = `
                <button class="action-btn view" data-id="${message.id}"><i class="fas fa-eye"></i></button>
                <button class="action-btn reply" data-id="${message.id}"><i class="fas fa-reply"></i></button>
            `;
        }
        
        // Get rating stars HTML
        function getRatingStars(rating) {
            if (!rating) return '';
            
            let stars = '';
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            
            for (let i = 0; i < fullStars; i++) {
                stars += '<i class="fas fa-star"></i>';
            }
            
            if (hasHalfStar) {
                stars += '<i class="fas fa-star-half-alt"></i>';
            }
            
            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
            for (let i = 0; i < emptyStars; i++) {
                stars += '<i class="far fa-star"></i>';
            }
            
            return stars;
        }
        
        // Show order details
        function showOrderDetails(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;
            
            currentOrder = order;
            
            const orderDetails = document.getElementById('orderDetailsContent');
            orderDetails.innerHTML = `
                <div style="margin-bottom: 20px;">
                    <h3 style="margin-bottom: 10px;">Order #${order.id.substring(0, 8)}</h3>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span style="color: var(--gray);">Date:</span>
                        <span>${new Date(order.createdAt).toLocaleString()}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span style="color: var(--gray);">Status:</span>
                        <span class="status ${order.status || 'pending'}">${order.status || 'pending'}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span style="color: var(--gray);">Payment Method:</span>
                        <span>${order.paymentMethod || 'Cash on Delivery'}</span>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="margin-bottom: 10px;">Customer Details</h4>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span style="color: var(--gray);">Name:</span>
                        <span>${order.userName || 'Not provided'}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span style="color: var(--gray);">Email:</span>
                        <span>${order.userEmail}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span style="color: var(--gray);">Phone:</span>
                        <span>${order.userPhone || 'Not provided'}</span>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="margin-bottom: 10px;">Shipping Address</h4>
                    <div style="margin-bottom: 5px;">
                        ${order.shippingAddress || 'Not provided'}
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="margin-bottom: 10px;">Order Items</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <thead>
                            <tr style="border-bottom: 1px solid #eee;">
                                <th style="padding: 10px 0; text-align: left;">Product</th>
                                <th style="padding: 10px 0; text-align: right;">Price</th>
                                <th style="padding: 10px 0; text-align: center;">Qty</th>
                                <th style="padding: 10px 0; text-align: right;">Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid #eee;">
                                <td style="padding: 10px 0;">
                                    <div style="display: flex; align-items: center;">
                                        <img src="${order.productImage}" alt="${order.productTitle}" style="width: 40px; height: 40px; object-fit: cover; border-radius: 4px; margin-right: 10px;">
                                        <div>
                                            <div style="font-weight: 500;">${order.productTitle}</div>
                                        </div>
                                    </div>
                                </td>
                                <td style="padding: 10px 0; text-align: right;">₹${order.price}</td>
                                <td style="padding: 10px 0; text-align: center;">${order.quantity}</td>
                                <td style="padding: 10px 0; text-align: right;">₹${order.total}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div style="border-top: 1px solid #eee; padding-top: 15px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px; font-weight: 500;">
                        <span>Total:</span>
                        <span>₹${order.total}</span>
                    </div>
                </div>
            `;
            
            orderModal.classList.add('active');
        }
        
        // Show message details and conversation
        function showMessageDetails(messageId) {
            database.ref('messages/' + messageId).once('value').then((snapshot) => {
                const messageThread = snapshot.val();
                if (!messageThread) return;
                
                currentMessageThread = messageThread;
                currentMessageThread.id = messageId;
                
                const messageDetails = document.getElementById('messageDetailsContent');
                messageDetails.innerHTML = `
                    <div style="margin-bottom: 20px;">
                        <h3 style="margin-bottom: 10px;">${messageThread.subject || 'No Subject'}</h3>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="color: var(--gray);">From:</span>
                            <span>${messageThread.userName || 'Unknown User'} (${messageThread.userEmail})</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="color: var(--gray);">Started:</span>
                            <span>${new Date(messageThread.createdAt).toLocaleString()}</span>
                        </div>
                    </div>
                    
                    <div class="message-container">
                        ${renderMessageConversation(messageThread.messages)}
                    </div>
                `;
                
                // Mark messages as read when opened
                markMessagesAsRead(messageThread);
                
                messageModal.classList.add('active');
            });
        }
        
        // Render message conversation
        function renderMessageConversation(messages) {
            if (!messages) return '<p>No messages in this conversation.</p>';
            
            let html = '';
            const sortedMessages = Object.values(messages).sort((a, b) => a.timestamp - b.timestamp);
            
            sortedMessages.forEach(msg => {
                html += `
                    <div class="message ${msg.isAdminReply ? 'admin' : 'user'}">
                        <div class="message-header">
                            <span class="message-sender">${msg.isAdminReply ? 'Admin' : (currentMessageThread.userName || 'User')}</span>
                            <span class="message-time">${new Date(msg.timestamp).toLocaleString()}</span>
                        </div>
                        <div class="message-content">${msg.content}</div>
                    </div>
                `;
            });
            
            return html;
        }
        
        // Mark messages as read
        function markMessagesAsRead(messageThread) {
            if (!messageThread.messages) return;
            
            const updates = {};
            let hasUpdates = false;
            
            // Find all unread messages from user and mark them as read
            Object.keys(messageThread.messages).forEach(key => {
                const msg = messageThread.messages[key];
                if (!msg.isAdminReply && msg.status === 'unread') {
                    updates[`messages/${messageThread.id}/messages/${key}/status`] = 'read';
                    hasUpdates = true;
                }
            });
            
            if (hasUpdates) {
                database.ref().update(updates)
                    .then(() => console.log('Messages marked as read'))
                    .catch(error => console.error('Error marking messages as read:', error));
            }
        }
        
        // Send reply to message thread
        function sendReply() {
            const replyContent = document.getElementById('replyMessage').value.trim();
            if (!replyContent || !currentMessageThread) return;
            
            const newMessageKey = database.ref().child('messages').push().key;
            const timestamp = Date.now();
            
            const messageData = {
                content: replyContent,
                timestamp: timestamp,
                isAdminReply: true,
                status: 'read' // Admin messages are always marked as read
            };
            
            const updates = {};
            updates[`messages/${currentMessageThread.id}/messages/${newMessageKey}`] = messageData;
            updates[`messages/${currentMessageThread.id}/updatedAt`] = timestamp;
            
            database.ref().update(updates)
                .then(() => {
                    alert('Reply sent successfully!');
                    document.getElementById('replyMessage').value = '';
                    // Refresh the message view
                    showMessageDetails(currentMessageThread.id);
                })
                .catch(error => {
                    alert('Error sending reply: ' + error.message);
                });
        }
        
        // Setup event listeners
        function setupEventListeners() {
            // Navigation
            dashboardBtn.addEventListener('click', () => {
                showSection(dashboardSection);
                setActiveNav(dashboardBtn);
            });
            
            productsBtn.addEventListener('click', () => {
                showSection(productsSection);
                setActiveNav(productsBtn);
            });
            
            categoriesBtn.addEventListener('click', () => {
                showSection(categoriesSection);
                setActiveNav(categoriesBtn);
            });
            
            ordersBtn.addEventListener('click', () => {
                showSection(ordersSection);
                setActiveNav(ordersBtn);
            });
            
            usersBtn.addEventListener('click', () => {
                showSection(usersSection);
                setActiveNav(usersBtn);
            });
            
            messagesBtn.addEventListener('click', () => {
                showSection(messagesSection);
                setActiveNav(messagesBtn);
            });
            
            settingsBtn.addEventListener('click', () => {
                showSection(settingsSection);
                setActiveNav(settingsBtn);
            });
            
            logoutBtn.addEventListener('click', () => {
                auth.signOut().then(() => {
                    window.location.href = 'login.html';
                });
            });
            
            // Show section
            function showSection(section) {
                dashboardSection.style.display = 'none';
                productsSection.style.display = 'none';
                categoriesSection.style.display = 'none';
                ordersSection.style.display = 'none';
                usersSection.style.display = 'none';
                messagesSection.style.display = 'none';
                settingsSection.style.display = 'none';
                
                section.style.display = 'block';
            }
            
            // Set active nav
            function setActiveNav(btn) {
                dashboardBtn.classList.remove('active');
                productsBtn.classList.remove('active');
                categoriesBtn.classList.remove('active');
                ordersBtn.classList.remove('active');
                usersBtn.classList.remove('active');
                messagesBtn.classList.remove('active');
                settingsBtn.classList.remove('active');
                
                btn.classList.add('active');
            }
            
            // Add product buttons
            addProductBtn.addEventListener('click', () => {
                productForm.reset();
                document.querySelector('.modal-title').textContent = 'Add New Product';
                productModal.classList.add('active');
            });
            
            addNewProductBtn.addEventListener('click', () => {
                productForm.reset();
                document.querySelector('.modal-title').textContent = 'Add New Product';
                productModal.classList.add('active');
            });
            
            // Add category button
            addCategoryBtn.addEventListener('click', () => {
                categoryForm.reset();
                document.querySelector('.modal-title').textContent = 'Add New Category';
                categoryModal.classList.add('active');
            });
            
            // Save product
            saveProductBtn.addEventListener('click', () => {
                const productData = {
                    title: document.getElementById('productName').value,
                    category: document.getElementById('productCategory').value,
                    description: document.getElementById('productDescription').value,
                    price: parseFloat(document.getElementById('productPrice').value),
                    originalPrice: parseFloat(document.getElementById('productOriginalPrice').value) || null,
                    discount: parseInt(document.getElementById('productDiscount').value) || null,
                    stock: parseInt(document.getElementById('productStock').value),
                    brand: document.getElementById('productBrand').value,
                    image: document.getElementById('productImage').value,
                    rating: parseFloat(document.getElementById('productRating').value) || null,
                    ratingCount: parseInt(document.getElementById('productRatingCount').value) || null,
                    features: document.getElementById('productFeatures').value ? 
                        JSON.parse(document.getElementById('productFeatures').value) : {}
                };
                
                // Add to Firebase
                database.ref('products').push(productData)
                    .then(() => {
                        alert('Product added successfully!');
                        productModal.classList.remove('active');
                    })
                    .catch(error => {
                        alert('Error adding product: ' + error.message);
                    });
            });
            
            // Save category
            saveCategoryBtn.addEventListener('click', () => {
                const categoryData = {
                    name: document.getElementById('categoryName').value,
                    id: document.getElementById('categoryId').value,
                    icon: document.getElementById('categoryIcon').value,
                    image: document.getElementById('categoryImage').value
                };
                
                // Add to Firebase
                database.ref('categories/' + categoryData.id).set(categoryData)
                    .then(() => {
                        alert('Category added successfully!');
                        categoryModal.classList.remove('active');
                    })
                    .catch(error => {
                        alert('Error adding category: ' + error.message);
                    });
            });
            
            // Close modals
            cancelProductBtn.addEventListener('click', () => {
                productModal.classList.remove('active');
            });
            
            cancelCategoryBtn.addEventListener('click', () => {
                categoryModal.classList.remove('active');
            });
            
            closeOrderBtn.addEventListener('click', () => {
                orderModal.classList.remove('active');
            });
            
            closeMessageBtn.addEventListener('click', () => {
                messageModal.classList.remove('active');
            });
            
            document.querySelectorAll('.modal-close').forEach(closeBtn => {
                closeBtn.addEventListener('click', () => {
                    productModal.classList.remove('active');
                    categoryModal.classList.remove('active');
                    orderModal.classList.remove('active');
                    messageModal.classList.remove('active');
                });
            });
            
            // Send reply
            sendReplyBtn.addEventListener('click', sendReply);
            replyForm.addEventListener('submit', (e) => {
                e.preventDefault();
                sendReply();
            });
            
            // Update order status
            updateOrderBtn.addEventListener('click', () => {
                if (!currentOrder) return;
                
                const newStatus = prompt('Enter new status (pending/completed/cancelled):', currentOrder.status || 'pending');
                
                if (newStatus && ['pending', 'completed', 'cancelled'].includes(newStatus.toLowerCase())) {
                    database.ref('orders/' + currentOrder.id + '/status').set(newStatus.toLowerCase())
                        .then(() => {
                            alert('Order status updated successfully!');
                            orderModal.classList.remove('active');
                        })
                        .catch(error => {
                            alert('Error updating order status: ' + error.message);
                        });
                }
            });
            
            // View order details
            document.addEventListener('click', (e) => {
                if (e.target.closest('.action-btn.view')) {
                    const btn = e.target.closest('.action-btn.view');
                    const id = btn.dataset.id;
                    
                    // Determine which table the button is in
                    if (btn.closest('#recentOrdersTable') || btn.closest('#allOrdersTable')) {
                        showOrderDetails(id);
                    } else if (btn.closest('#messagesTable')) {
                        showMessageDetails(id);
                    }
                }
                
                // Reply to message
                if (e.target.closest('.action-btn.reply')) {
                    const messageId = e.target.closest('.action-btn.reply').dataset.id;
                    showMessageDetails(messageId);
                }
                
                // Edit product
                if (e.target.closest('.action-btn.edit')) {
                    const productId = e.target.closest('.action-btn.edit').dataset.id;
                    const product = products.find(p => p.id === productId);
                    
                    if (product) {
                        document.getElementById('productName').value = product.title;
                        document.getElementById('productCategory').value = product.category;
                        document.getElementById('productDescription').value = product.description;
                        document.getElementById('productPrice').value = product.price;
                        document.getElementById('productOriginalPrice').value = product.originalPrice || '';
                        document.getElementById('productDiscount').value = product.discount || '';
                        document.getElementById('productStock').value = product.stock;
                        document.getElementById('productBrand').value = product.brand || '';
                        document.getElementById('productImage').value = product.image;
                        document.getElementById('productRating').value = product.rating || '';
                        document.getElementById('productRatingCount').value = product.ratingCount || '';
                        document.getElementById('productFeatures').value = JSON.stringify(product.features || {});
                        
                        document.querySelector('.modal-title').textContent = 'Edit Product';
                        productModal.classList.add('active');
                        
                        // Update save button to edit instead of add
                        saveProductBtn.onclick = () => {
                            const productData = {
                                title: document.getElementById('productName').value,
                                category: document.getElementById('productCategory').value,
                                description: document.getElementById('productDescription').value,
                                price: parseFloat(document.getElementById('productPrice').value),
                                originalPrice: parseFloat(document.getElementById('productOriginalPrice').value) || null,
                                discount: parseInt(document.getElementById('productDiscount').value) || null,
                                stock: parseInt(document.getElementById('productStock').value),
                                brand: document.getElementById('productBrand').value,
                                image: document.getElementById('productImage').value,
                                rating: parseFloat(document.getElementById('productRating').value) || null,
                                ratingCount: parseInt(document.getElementById('productRatingCount').value) || null,
                                features: document.getElementById('productFeatures').value ? 
                                    JSON.parse(document.getElementById('productFeatures').value) : {}
                            };
                            
                            // Update in Firebase
                            database.ref('products/' + productId).update(productData)
                                .then(() => {
                                    alert('Product updated successfully!');
                                    productModal.classList.remove('active');
                                })
                                .catch(error => {
                                    alert('Error updating product: ' + error.message);
                                });
                        };
                    }
                }
                
                // Delete product
                if (e.target.closest('.action-btn.delete')) {
                    if (confirm('Are you sure you want to delete this product?')) {
                        const productId = e.target.closest('.action-btn.delete').dataset.id;
                        
                        // Delete from Firebase
                        database.ref('products/' + productId).remove()
                            .then(() => {
                                alert('Product deleted successfully!');
                            })
                            .catch(error => {
                                alert('Error deleting product: ' + error.message);
                            });
                    }
                }
            });
        }
    </script>
</body>
</html>
